{"name":"macos","postlist":[{"title":"Android真机调试常用命令","slug":"android真机调试常用命令","date":"2019-04-28T12:39:32.000Z","updated":"2020-08-15T03:08:21.000Z","comments":true,"path":"api/articles/android真机调试常用命令.json","excerpt":"使用USB连接Android真机调试时，使用无线连接调试会方便很多，并使用电脑端用adb命令实现截图和录屏，方便调试和问题反馈。<br>","cover":null,"content":"<p>使用USB连接Android真机调试时，使用无线连接调试会方便很多，并使用电脑端用adb命令实现截图和录屏，方便调试和问题反馈。<br><span id=\"more\"></span></p>\n<h2 id=\"无线调试\"><a href=\"#无线调试\" class=\"headerlink\" title=\"无线调试\"></a>无线调试</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 前提条件：手机和电脑处理同一网段</span><br><span class=\"line\"># 第一次手机先使用USB连接电脑执行以下命令让手机上的某一端口处于监听状态</span><br><span class=\"line\">adb tcpip &lt;port&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"># 在手机上查看ip地址或使用以下命令查看ip</span><br><span class=\"line\">adb shell ifconfig </span><br><span class=\"line\"># 连接手机（在同一个环境下，一般手机/电脑不重启就会一直连接着）</span><br><span class=\"line\">adb connect &lt;ip&gt; :&lt;port&gt;</span><br><span class=\"line\"># 查看连接的设备</span><br><span class=\"line\">adb devices</span><br></pre></td></tr></table></figure>\n<h2 id=\"截图\"><a href=\"#截图\" class=\"headerlink\" title=\"截图\"></a>截图</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 截图并保存到手机sd卡的下</span><br><span class=\"line\">adb shell screencap -p /sdcard/screenshot.png</span><br></pre></td></tr></table></figure>\n<p>便捷脚本（截图并自动复制到电脑剪切板/保存到电脑本地）</p>\n<blockquote>\n<p>因脚本里调用了linux/macOS的命令，所以只适用于macOS系统，windows请自行修改脚本。</p>\n</blockquote>\n<p><code>vi shot.sh</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"># Android截图，定位和预览默认关闭，请取消注释</span><br><span class=\"line\"></span><br><span class=\"line\">dd=`date +%Y-%m-%d-%H-%M-%S`</span><br><span class=\"line\">pwd=`pwd`</span><br><span class=\"line\">adb shell screencap -p /sdcard/screenshot.png</span><br><span class=\"line\">adb pull /sdcard/screenshot.png</span><br><span class=\"line\">adb shell rm /sdcard/screenshot.png</span><br><span class=\"line\">mv screenshot.png $dd.png</span><br><span class=\"line\">echo &quot;截图已保存为当前目录下的&quot;$dd.png</span><br><span class=\"line\"># 修改图片尺寸，长或宽最大不超过960，等比缩放</span><br><span class=\"line\">echo &quot;压缩图片...&quot;</span><br><span class=\"line\">sips -Z 960 $pwd/$dd.png</span><br><span class=\"line\"># 定位到文件</span><br><span class=\"line\">open ./$dd.png -R</span><br><span class=\"line\"># 打开预览</span><br><span class=\"line\">open -a Preview $dd.png</span><br><span class=\"line\"># 复制到剪切板</span><br><span class=\"line\">osascript -e &#x27;on run args&#x27; -e &#x27;set the clipboard to POSIX file (first item of args)&#x27; -e end $pwd/$dd.png</span><br><span class=\"line\">echo &quot;截图已复制到剪切板&quot;</span><br></pre></td></tr></table></figure>\n<p>授予执行权限<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a+x shot.sh</span><br></pre></td></tr></table></figure></p>\n<p>使用方法</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./shot.sh</span><br></pre></td></tr></table></figure>\n<p>⌘+v试试</p>\n<p><em>可把命令添加alias别名</em></p>\n<h2 id=\"录屏\"><a href=\"#录屏\" class=\"headerlink\" title=\"录屏\"></a>录屏</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 执行录屏并保存到手机sd卡目录下（默认时长180s）</span><br><span class=\"line\"># 可配置参数</span><br><span class=\"line\"># --time-limit: 录制时长，单位秒</span><br><span class=\"line\"># --size: 分辨率，如1280*720，不指定默认使用手机的分辨率</span><br><span class=\"line\"># --bit-rate: 视频的比特率，如6Mbps为6000000</span><br><span class=\"line\"># --verbose: 命令行显示log</span><br><span class=\"line\">adb shell screenrecord /sdcard/demo.mp4</span><br></pre></td></tr></table></figure>\n<p>便捷脚本（录屏并自动复制到电脑剪切板/保存到电脑本地）</p>\n<blockquote>\n<p>因脚本里调用了linux/macOS的命令，所以只适用于macOS系统，windows请自行修改脚本。</p>\n</blockquote>\n<p><code>vi record.sh</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"># Android录屏</span><br><span class=\"line\">dd=`date +%Y-%m-%d-%H-%M-%S`&quot;-$1s&quot;</span><br><span class=\"line\">pwd=`pwd`</span><br><span class=\"line\">adb shell screenrecord --time-limit $1 /sdcard/screenrecord.mp4</span><br><span class=\"line\">adb pull /sdcard/screenrecord.mp4</span><br><span class=\"line\">adb shell rm /sdcard/screenrecord.mp4</span><br><span class=\"line\">mv screenrecord.mp4 $dd.mp4</span><br><span class=\"line\">echo &quot;$1秒视频已保存为当前目录下的&quot;$dd.mp4</span><br><span class=\"line\"># 定位到文件</span><br><span class=\"line\">open ./$dd.mp4 -R</span><br><span class=\"line\"># 复制到剪切板</span><br><span class=\"line\">osascript -e &#x27;on run args&#x27; -e &#x27;set the clipboard to POSIX file (first item of args)&#x27; -e end $pwd/$dd.mp4</span><br><span class=\"line\">echo &quot;$1秒视频已复制到剪切板&quot;</span><br></pre></td></tr></table></figure>\n<p>授予执行权限<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod a+x record.sh</span><br></pre></td></tr></table></figure></p>\n<p>使用方法<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 3为录制秒数，可修改</span><br><span class=\"line\">./record.sh 3</span><br></pre></td></tr></table></figure></p>\n","raw":null,"categories":[{"name":"程序员","path":"api/categories/程序员.json"}],"tags":[{"name":"android","path":"api/tags/android.json"},{"name":"macos","path":"api/tags/macos.json"},{"name":"命令","path":"api/tags/命令.json"},{"name":"效率","path":"api/tags/效率.json"},{"name":"无线","path":"api/tags/无线.json"},{"name":"调试","path":"api/tags/调试.json"},{"name":"adb","path":"api/tags/adb.json"},{"name":"usb","path":"api/tags/usb.json"}]},{"title":"在macOS上更改Jenkins的默认用户，解决权限问题","slug":"在macos上更改jenkins默认用户解决权限问题","date":"2017-08-24T06:29:14.000Z","updated":"2020-08-15T03:08:14.000Z","comments":true,"path":"api/articles/在macos上更改jenkins默认用户解决权限问题.json","excerpt":"<br /><br>","cover":null,"content":"<p><br /><br><span id=\"more\"></span><br>在MacOS上使用<code>dmg</code>安装包安装完Jenkins之后，发了Jenkins自动在系统里新建了一个名为<code>jenkins</code>的用户。默认的，Jenkins程序里的自动化构建操作都是以这个用户身份来进行的，所以有时会出现一些权限问题，解决方法就是修改Jenkins配置文件，把Jenkins运行的默认账户改成平时用的账户。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">停止Jenkins</span></span><br><span class=\"line\">sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">修改Group和User</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">&lt;用户名&gt;填写你的MacOS用户名，不知道的可以在命令行使用<span class=\"built_in\">whoami</span>查看，不需要尖括号</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$ </span><span class=\"language-bash\">sudo vim +1 +/daemon +’s/daemon/staff/’ +/daemon +’s/daemon/&lt;用户名&gt; +wq org.jenkins-ci.plist</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">可能相应文件夹的权限</span></span><br><span class=\"line\">sudo chown -R &lt;用户名&gt;:staff /Users/Shared/Jenkins/</span><br><span class=\"line\">sudo chown -R &lt;用户名&gt;:staff /var/log/jenkins/</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">启动Jenkins</span></span><br><span class=\"line\">sudo launchctl load /Library/LaunchDaemons/org.jenkins-ci.plist</span><br></pre></td></tr></table></figure>","raw":null,"categories":[{"name":"程序猿","path":"api/categories/程序猿.json"}],"tags":[{"name":"macos","path":"api/tags/macos.json"},{"name":"jenkins","path":"api/tags/jenkins.json"},{"name":"权限","path":"api/tags/权限.json"},{"name":"用户","path":"api/tags/用户.json"}]}]}